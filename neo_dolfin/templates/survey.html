<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>DolFin - News</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='css/main.css')}}">
  <link rel="stylesheet" type="text/css" href="../static/css/survey.css">


  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600;800&display=swap');
  </style>
  <script src="{{url_for('static', filename='js/survey.js')}}"></script>
</head>

<body>
  <!-- IMPLEMENT NAV BAR HERE -->
  {% include 'components/navbar.html' %}
  <p style="color:rgb(255, 0, 0);font-family:courier;font-size:50%;"><strong>{{msg}}</strong></p>
  <div id="mainBody">

    <div id="headerSection" class="p-5">
      <h1 id="headerTitle" class="display-1 text-center ">Survey</h1>
    </div>

    <svg id="rectangleDivider" width="100%" height="12" fill="none" xmlns="http://www.w3.org/2000/svg">
      <rect width="100%" height="12" fill="#343A40" />
    </svg>
  </div>

  <div id="mainNewsColumns" class="container">
    <div class="row" style="min-height: 700px;">
        <div class="popup" id="feedbackPopup">
            <form id="surveyForm" method="POST">
                <h4 class="top-header">Have you seen the information you wanted on the dashboard?</h4>
                <div class="dashboard-question">
                  <input type="radio" name="question1" id="dashboard-question-yes1" onclick="showHideTextArea('dashboard-question-no1', 'textAreaContainer1')">
                  <label for="dashboard-question-yes1">Yes</label>
                  <input type="radio" name="question1" id="dashboard-question-no1" onclick="showHideTextArea('dashboard-question-no1', 'textAreaContainer1')">
                  <label for="dashboard-question-no1">No</label>
                </div>
                <div style="display:none;" id="textAreaContainer1">
                  <textarea class="dashboard-textbox-box" id="text-box-1" placeholder="Elaborate in 100 words or less" rows="3" cols="160" oninput="countWords('dashboard-textbox-box', 'wordCount1')"></textarea>
                  <div class="wordCount" id="wordCount1">0 words</div>
                </div>

                <h4>How satisfied are you with the Dolfin app's user interface and navigation?</h4>
                <div class="faces" id="faces2">
                  <span class="face" onclick="changeColor(this, 'faces2', 1)" id="face2_1">Very unsatisified</span>
                  <span class="face" onclick="changeColor(this, 'faces2', 2)" id="face2_2">Unsatisified</span>
                  <span class="face" onclick="changeColor(this, 'faces2', 3)" id="face2_3">Neutral</span>
                  <span class="face" onclick="changeColor(this, 'faces2', 4)" id="face2_4">Satisfied</span>
                  <span class="face" onclick="changeColor(this, 'faces2', 5)" id="face2_5">Very satisfied</span>
              </div>

                <h4>How easy was it to access and interpret the predicted yearly balance and expenditure categories displayed on the dashboard?</h4>
                <div class="faces" id="faces3">
                  <span class="face" onclick="changeColor(this, 'faces3', 1)" id="face3_1">Very Difficult</span>
                  <span class="face" onclick="changeColor(this, 'faces3', 2)" id="face3_2">Slightly Difficult</span>
                  <span class="face" onclick="changeColor(this, 'faces3', 3)" id="face3_3">Neither Difficult nor Easy</span>
                  <span class="face" onclick="changeColor(this, 'faces3', 4)" id="face3_4">Slightly Easy</span>
                  <span class="face" onclick="changeColor(this, 'faces3', 5)" id="face3_5">Very Easy</span>
              </div>
                <h4>Were the features provided by Dolfin (such as budgeting tools, expenditure breakdowns) helpful in managing your finances?</h4>
                <div class="dashboard-question">
                  <input type="radio" name="question2" id="dashboard-question-yes2" onclick="showHideTextArea('dashboard-question-no2', 'textAreaContainer2')">
                  <label for="dashboard-question-yes2">Yes</label>
                  <input type="radio" name="question2" id="dashboard-question-no2" onclick="showHideTextArea('dashboard-question-no2', 'textAreaContainer2')">
                  <label for="dashboard-question-no2">No</label>
                </div>
                <div style="display:none;" id="textAreaContainer2">
                  <textarea class="dashboard-textbox-box2" id="text-box-2" placeholder="Elaborate in 100 words or less" rows="3" cols="160" oninput="countWords('dashboard-textbox-box2', 'wordCount2')"></textarea>
                  <div class="wordCount" id="wordCount2">0 words</div>
                </div>
                <h4>Did you encounter any challenges or limitations while using specific features on the Dolfin app related to predicting yearly balance or expenditure categories?</h4>
                <div class="dashboard-question">
                  <input type="radio" name="question3" id="dashboard-question-yes3" onclick="showHideTextArea('dashboard-question-no3', 'textAreaContainer3')">
                  <label for="dashboard-question-yes3">Yes</label>
                  <input type="radio" name="question3" id="dashboard-question-no3" onclick="showHideTextArea('dashboard-question-no3', 'textAreaContainer3')">
                  <label for="dashboard-question-no3">No</label>
                </div>
                <div style="display:none;" id="textAreaContainer3">
                  <textarea class="dashboard-textbox-box3" id="text-box-3" placeholder="Elaborate in 100 words or less" rows="3" cols="160" oninput="countWords('dashboard-textbox-box3', 'wordCount3')"></textarea>
                  <div class="wordCount" id="wordCount3">0 words</div>
                </div>
                <h4>How frequently did you access the dashboard to view the predicted yearly balance and expenditure categories?</h4>
                <div class="faces" id="faces4">
                    <span class="face" onclick="changeColor(this, 'faces4', 1)" id="face4_1">Daily</span>
                    <span class="face" onclick="changeColor(this, 'faces4', 2)" id="face4_2">Weekly</span>
                    <span class="face" onclick="changeColor(this, 'faces4', 3)" id="face4_3">Fortnightly</span>
                    <span class="face" onclick="changeColor(this, 'faces4', 4)" id="face4_4">Monthly</span>
                    <span class="face" onclick="changeColor(this, 'faces4', 5)" id="face4_5">Yearly</span>
                </div>
                <h4>What additional features or functionalities would you like to see implemented on the Dolfin app to enhance its usability and usefulness?</h4>
                <div id="textAreaContainer4">
                  <textarea class="dashboard-textbox-box4" id="text-box-4" placeholder="Elaborate in 100 words or less" rows="3" cols="160" oninput="countWords('dashboard-textbox-box4', 'wordCount4')"></textarea>
                  <div class="wordCount" id="wordCount4">0 words</div>
                </div>
                
                <h4>Are there any concerns or suggestions you have regarding the privacy or security of your financial information while using Dolfin?</h4>
                <div id="textAreaContainer5">
                  <textarea class="dashboard-textbox-box5" id="text-box-5" placeholder="Elaborate in 100 words or less" rows="3" cols="160" oninput="countWords('dashboard-textbox-box5', 'wordCount5')"></textarea>
                  <div class="wordCount" id="wordCount5">0 words</div>
                </div>
                <h4>How did you feel we did (1-poor to 5-excllent)?</h4>
                <br>
                <div class="faces" id="faces1">
                  <span class="face" onclick="changeColor(this, 'faces1', 1)" id="face1_1">1</span>
                  <span class="face" onclick="changeColor(this, 'faces1', 2)" id="face1_2">2</span>
                  <span class="face" onclick="changeColor(this, 'faces1', 3)" id="face1_3">3</span>
                  <span class="face" onclick="changeColor(this, 'faces1', 4)" id="face1_4">4</span>
                  <span class="face" onclick="changeColor(this, 'faces1', 5)" id="face1_5">5</span>
                </div>
                <div class="final-submit-button">
                    <button type="submit" class="submitting-button" onclick="submitForm()">Submit</button>
                </div>
                
        
                
            </form>
        </div>
        
        
        
    </div>

      
  </div>

  <!-- IMPLEMENT CHATBOT HERE -->
  {% include 'components/chatbotWidget.html' %}

  </div>
  {% include 'components/footer.html' %}
  
  <py-script>
    #!/usr/bin/env python
# coding: utf-8

# In[6]:


#Orignal data based on fake generated data.

import pandas as pd
import matplotlib.pyplot as plt


# In[11]:


def plot_financial_overview_for_user(user_id, file_path):
    import pandas as pd
    import matplotlib.pyplot as plt

    # Load the data from the specified Excel file
    data = pd.read_excel(file_path)
    
    # Ensure 'Date' is in datetime format
    data['Date'] = pd.to_datetime(data['Date'])
    
    # Add a 'User ID' field if it does not exist
    if 'User ID' not in data.columns:
        data['User ID'] = range(1, len(data) + 1)
    
    # Filter data for the specified user ID
    user_data = data[data['User ID'] == user_id]
    
    if user_data.empty:
        print(f"No data available for User ID: {user_id}")
        return

    # Define color scheme
    colors = {"Credit": "#0077bb", "Debit": "#d9d9d9", "Balance": "#343a40", "Text": "#abb5be"}

    # Plotting bars
    # Define positions for the groups
    bar_width = 0.15  # Slimmer bars
    r1 = range(len(user_data))
    r2 = [x + bar_width for x in r1]
    r3 = [x + 2 * bar_width for x in r1]

    # Create bars
    plt.figure(figsize=(14, 7))
    plt.bar(r1, user_data['Credit'], color=colors['Credit'], width=bar_width, edgecolor='grey', label='Credit')
    plt.bar(r2, user_data['Debit'], color=colors['Debit'], width=bar_width, edgecolor='grey', label='Debit')
    plt.bar(r3, user_data['Balance'], color=colors['Balance'], width=bar_width, edgecolor='grey', label='Balance')
    
    # Add xticks on the middle of the group bars
    plt.xlabel('Date', fontweight='bold')
    plt.xticks([r + bar_width for r in range(len(user_data))], user_data['Date'].dt.strftime('%Y-%m-%d'))
    
    # Adding labels and title
    plt.ylabel('Amount')
    plt.title(f'Financial Overview for User ID: {user_id}')

    # Display category information in light-toned colors
    category_info = f"Categories:\nCategory 1: {user_data['Category 1'].unique()}\nCategory 2: {user_data['Category 2'].unique()}\nCategory 3: {user_data['Category 3'].unique()}"
    plt.figtext(0.915, 0.5, category_info, ha="center", va="center", fontsize=10, bbox={"boxstyle":"round", "facecolor":colors['Text']})
    
    # Adjust layout to make room for category information
    plt.subplots_adjust(right=0.85)
    
    # Create legend & Show graphic
    plt.legend()
    plt.show()

# Example usage:
# plot_financial_overview_for_user(1, 'fake_bank_account_transactions2 1.xlsx')


# In[8]:


plot_financial_overview_for_user(2, 'fake_bank_account_transactions2 1.xlsx')


# In[13]:


def plot_category_summary(file_path):
    import pandas as pd
    import matplotlib.pyplot as plt

    # Load the data from the specified Excel file
    data = pd.read_excel(file_path)
    
    # Calculate totals for Category 1
    category1_totals = data.groupby(['Category 1']).agg({'Debit': 'sum', 'Credit': 'sum'})
    category2_totals = data.groupby(['Category 2']).agg({'Debit': 'sum', 'Credit': 'sum'})

    # Define color scheme
    colors = ["#0077bb", "#d9d9d9"]  # Blue for Credit, Gray for Debit

    # Plotting for Category 1
    plt.figure(figsize=(10, 6))
    category1_totals.plot(kind='bar', color=colors, width=0.8)
    plt.title('Income vs Expenditure for Category 1')
    plt.ylabel('Amount')
    plt.xlabel('Category')
    plt.xticks(rotation=0)
    plt.grid(True, linestyle='--', alpha=0.6)
    plt.legend(['Debit', 'Credit'])
    plt.tight_layout()

    # Plotting for Category 2
    plt.figure(figsize=(10, 6))
    category2_totals.plot(kind='bar', color=colors, width=0.8)
    plt.title('Income vs Expenditure for Category 2')
    plt.ylabel('Amount')
    plt.xlabel('Category')
    plt.xticks(rotation=45)
    plt.grid(True, linestyle='--', alpha=0.6)
    plt.legend(['Debit', 'Credit'])
    plt.tight_layout()

    plt.show()

# Example usage:
plot_category_summary('fake_bank_account_transactions2 1.xlsx')


# In[15]:


def plot_by_category_selection_interactive(file_path):
    import pandas as pd
    import matplotlib.pyplot as plt

    # Load the data from the specified Excel file
    data = pd.read_excel(file_path)
    
    # Get unique values for Category 1 and Category 2 for user to choose from
    category1_options = data['Category 1'].unique()
    category2_options = data['Category 2'].unique()
    
    # Display options and prompt user for input
    print("Available Category 1 options:", category1_options)
    category1_selection = input("Select a category from Category 1: ")
    
    print("Available Category 2 options:", category2_options)
    category2_selection = input("Select a category from Category 2: ")

    # Filter data based on user selection
    filtered_data = data[(data['Category 1'] == category1_selection) & (data['Category 2'] == category2_selection)]
    
    if filtered_data.empty:
        print(f"No data available for Category 1: {category1_selection} and Category 2: {category2_selection}")
        return

    # Group by Category 3 and calculate totals
    category3_totals = filtered_data.groupby('Category 3').agg({'Debit': 'sum', 'Credit': 'sum'})

    # Define color scheme
    colors = ["#0077bb", "#d9d9d9"]  # Blue for Credit, Gray for Debit

    # Plotting results
    plt.figure(figsize=(10, 6))
    category3_totals.plot(kind='bar', color=colors, width=0.8)
    plt.title(f'Income vs Expenditure for {category1_selection} - {category2_selection}')
    plt.ylabel('Amount')
    plt.xlabel('Category 3')
    plt.xticks(rotation=45)
    plt.grid(True, linestyle='--', alpha=0.6)
    plt.legend(['Debit', 'Credit'])
    plt.tight_layout()
    
    plt.show()


plot_by_category_selection_interactive('fake_bank_account_transactions2 1.xlsx')


# In[ ]:




  </py-script>
</body>

</html>